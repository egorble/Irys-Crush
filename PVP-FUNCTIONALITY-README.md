# IrysCrush PVP Functionality Documentation

## –û–≥–ª—è–¥

–í–∞—à —Å–º–∞—Ä—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç IrysCrushLeaderboard —Ç–µ–ø–µ—Ä —Ä–æ–∑—à–∏—Ä–µ–Ω–æ –∑ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–æ—é PVP —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—é! –ì—Ä–∞–≤—Ü—ñ –º–æ–∂—É—Ç—å —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∫—ñ–º–Ω–∞—Ç–∏, –∑–º–∞–≥–∞—Ç–∏—Å—è –æ–¥–∏–Ω –∑ –æ–¥–Ω–∏–º —Ç–∞ –≤–∏–≥—Ä–∞—Ç–∏ –ø—Ä–∏–∑–æ–≤—ñ –ø—É–ª–∏.

## –ù–æ–≤—ñ –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

### üè† –°–∏—Å—Ç–µ–º–∞ –ö—ñ–º–Ω–∞—Ç
- **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫—ñ–º–Ω–∞—Ç**: –ì—Ä–∞–≤—Ü—ñ –º–æ–∂—É—Ç—å —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –≤–ª–∞—Å–Ω—ñ PVP –∫—ñ–º–Ω–∞—Ç–∏
- **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≥—Ä–∏**: –í–∏–±—ñ—Ä —á–∞—Å—É –≥—Ä–∏ (60-3600 —Å–µ–∫—É–Ω–¥) —Ç–∞ –ø–ª–∞—Ç–∏ –∑–∞ –≤—Ö—ñ–¥
- **–ú–∞–∫—Å–∏–º—É–º –≥—Ä–∞–≤—Ü—ñ–≤**: 2-10 –≥—Ä–∞–≤—Ü—ñ–≤ –Ω–∞ –∫—ñ–º–Ω–∞—Ç—É
- **–°—Ç–∞–Ω–∏ –∫—ñ–º–Ω–∞—Ç**: WaitingForPlayers ‚Üí InProgress ‚Üí Finished

### üí∞ –°–∏—Å—Ç–µ–º–∞ –ü–ª–∞—Ç–µ–∂—ñ–≤
- **–ü–ª–∞—Ç–∞ –∑–∞ –≤—Ö—ñ–¥**: –í –Ω–∞—Ç–∏–≤–Ω–∏—Ö —Ç–æ–∫–µ–Ω–∞—Ö Irys
- **–ü—Ä–∏–∑–æ–≤–∏–π –ø—É–ª**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ñ–æ—Ä–º—É—î—Ç—å—Å—è –∑ –ø–ª–∞—Ç–µ–∂—ñ–≤ –≥—Ä–∞–≤—Ü—ñ–≤
- **–†–æ–∑–ø–æ–¥—ñ–ª –ø—Ä–∏–∑—ñ–≤**: –ü–µ—Ä–µ–º–æ–∂–µ—Ü—å –æ—Ç—Ä–∏–º—É—î –≤–µ—Å—å –ø—Ä–∏–∑–æ–≤–∏–π –ø—É–ª

### üèÜ –õ—ñ–¥–µ—Ä–±–æ—Ä–¥–∏ –ö—ñ–º–Ω–∞—Ç
- **–Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω—ñ –ª—ñ–¥–µ—Ä–±–æ—Ä–¥–∏**: –ö–æ–∂–Ω–∞ –∫—ñ–º–Ω–∞—Ç–∞ –º–∞—î –≤–ª–∞—Å–Ω–∏–π –ª—ñ–¥–µ—Ä–±–æ—Ä–¥
- **–°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∑–∞ –æ—á–∫–∞–º–∏**: –ì—Ä–∞–≤—Ü—ñ —Å–æ—Ä—Ç—É—é—Ç—å—Å—è –∑–∞ –Ω–∞–π–≤–∏—â–∏–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
- **–°—Ç–∞—Ç—É—Å –ø–æ–¥–∞–Ω–Ω—è**: –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —á–∏ –ø–æ–¥–∞–≤ –≥—Ä–∞–≤–µ—Ü—å —Å–≤—ñ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

## –û—Å–Ω–æ–≤–Ω—ñ –§—É–Ω–∫—Ü—ñ—ó

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ö—ñ–º–Ω–∞—Ç–∏
```solidity
function createPVPRoom(
    uint256 _entryFee,      // –ü–ª–∞—Ç–∞ –∑–∞ –≤—Ö—ñ–¥ –≤ wei
    uint256 _gameDuration,  // –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –≥—Ä–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (60-3600)
    uint256 _maxPlayers     // –ú–∞–∫—Å–∏–º—É–º –≥—Ä–∞–≤—Ü—ñ–≤ (2-10)
) external payable returns (uint256 roomId)
```

### –ü—Ä–∏—î–¥–Ω–∞–Ω–Ω—è –¥–æ –ö—ñ–º–Ω–∞—Ç–∏
```solidity
function joinPVPRoom(uint256 _roomId) external payable
```

### –ü–æ—á–∞—Ç–æ–∫ –ì—Ä–∏ (—Ç—ñ–ª—å–∫–∏ —Ö–æ—Å—Ç)
```solidity
function startGame(uint256 _roomId) external
```

### –ü–æ–¥–∞–Ω–Ω—è –†–µ–∑—É–ª—å—Ç–∞—Ç—É
```solidity
function submitScoreToRoom(uint256 _roomId, uint256 _score) external
```

### –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è –ì—Ä–∏
```solidity
function finishGame(uint256 _roomId) external
```

## –§—É–Ω–∫—Ü—ñ—ó –ü–µ—Ä–µ–≥–ª—è–¥—É

### –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –ö—ñ–º–Ω–∞—Ç—É
```solidity
function getRoomInfo(uint256 _roomId) external view returns (
    address host,
    uint256 entryFee,
    uint256 gameDuration,
    uint256 maxPlayers,
    uint256 currentPlayers,
    RoomState state,
    uint256 prizePool,
    uint256 startTime,
    address winner
)
```

### –õ—ñ–¥–µ—Ä–±–æ—Ä–¥ –ö—ñ–º–Ω–∞—Ç–∏
```solidity
function getRoomLeaderboard(uint256 _roomId) external view returns (
    address[] memory addresses,
    string[] memory nicknames,
    uint256[] memory scores,
    bool[] memory hasSubmitted
)
```

### –î–æ—Å—Ç—É–ø–Ω—ñ –ö—ñ–º–Ω–∞—Ç–∏
```solidity
function getJoinableRooms() external view returns (
    uint256[] memory roomIds,
    address[] memory hosts,
    uint256[] memory entryFees,
    uint256[] memory gameDurations,
    uint256[] memory currentPlayers,
    uint256[] memory maxPlayers
)
```

### –ß–∞—Å —â–æ –ó–∞–ª–∏—à–∏–≤—Å—è
```solidity
function getRemainingTime(uint256 _roomId) external view returns (uint256 remainingTime)
```

## –õ–æ–≥—ñ–∫–∞ –ì—Ä–∏

### 1. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ö—ñ–º–Ω–∞—Ç–∏
1. –ì—Ä–∞–≤–µ—Ü—å –≤–∏–∫–ª–∏–∫–∞—î `createPVPRoom()` –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –≥—Ä–∏
2. –ü–ª–∞—Ç–∏—Ç—å entry fee —è–∫ msg.value
3. –°—Ç–∞—î —Ö–æ—Å—Ç–æ–º –∫—ñ–º–Ω–∞—Ç–∏ —Ç–∞ –ø–µ—Ä—à–∏–º –≥—Ä–∞–≤—Ü–µ–º
4. –ö—ñ–º–Ω–∞—Ç–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –≤ —Å—Ç–∞–Ω `WaitingForPlayers`

### 2. –ü—Ä–∏—î–¥–Ω–∞–Ω–Ω—è –ì—Ä–∞–≤—Ü—ñ–≤
1. –Ü–Ω—à—ñ –≥—Ä–∞–≤—Ü—ñ –≤–∏–∫–ª–∏–∫–∞—é—Ç—å `joinPVPRoom()`
2. –ü–ª–∞—Ç—è—Ç—å entry fee
3. –î–æ–¥–∞—é—Ç—å—Å—è –¥–æ —Å–ø–∏—Å–∫—É –≥—Ä–∞–≤—Ü—ñ–≤ –∫—ñ–º–Ω–∞—Ç–∏
4. –ü—Ä–∏–∑–æ–≤–∏–π –ø—É–ª –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è

### 3. –ü–æ—á–∞—Ç–æ–∫ –ì—Ä–∏
1. –•–æ—Å—Ç –≤–∏–∫–ª–∏–∫–∞—î `startGame()` –∫–æ–ª–∏ –≥–æ—Ç–æ–≤–∏–π
2. –ü–æ—Ç—Ä—ñ–±–Ω–æ –º—ñ–Ω—ñ–º—É–º 2 –≥—Ä–∞–≤—Ü—ñ
3. –ö—ñ–º–Ω–∞—Ç–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –≤ —Å—Ç–∞–Ω `InProgress`
4. –ó–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è —Ç–∞–π–º–µ—Ä –≥—Ä–∏

### 4. –ü–æ–¥–∞–Ω–Ω—è –†–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
1. –ì—Ä–∞–≤—Ü—ñ –≥—Ä–∞—é—Ç—å —Ç–∞ –≤–∏–∫–ª–∏–∫–∞—é—Ç—å `submitScoreToRoom()`
2. –ö–æ–∂–µ–Ω –≥—Ä–∞–≤–µ—Ü—å –º–æ–∂–µ –ø–æ–¥–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç—ñ–ª—å–∫–∏ –æ–¥–∏–Ω —Ä–∞–∑
3. –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ –ª—ñ–¥–µ—Ä–±–æ—Ä–¥—ñ –∫—ñ–º–Ω–∞—Ç–∏

### 5. –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è –ì—Ä–∏
1. –ì—Ä–∞ –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–æ–ª–∏:
   - –í—Å—ñ –≥—Ä–∞–≤—Ü—ñ –ø–æ–¥–∞–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏, –ê–ë–û
   - –ß–∞—Å –≥—Ä–∏ –∑–∞–∫—ñ–Ω—á–∏–≤—Å—è
2. –í–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –ø–µ—Ä–µ–º–æ–∂–µ—Ü—å (–Ω–∞–π–≤–∏—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
3. –ü—Ä–∏–∑–æ–≤–∏–π –ø—É–ª –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å—Å—è –ø–µ—Ä–µ–º–æ–∂—Ü—é
4. –ö—ñ–º–Ω–∞—Ç–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –≤ —Å—Ç–∞–Ω `Finished`

## –ü–æ–¥—ñ—ó (Events)

```solidity
event RoomCreated(uint256 indexed roomId, address indexed host, uint256 entryFee, uint256 gameDuration, uint256 maxPlayers);
event PlayerJoinedRoom(uint256 indexed roomId, address indexed player);
event GameStarted(uint256 indexed roomId, uint256 startTime);
event ScoreSubmittedToRoom(uint256 indexed roomId, address indexed player, uint256 score);
event GameFinished(uint256 indexed roomId, address indexed winner, uint256 prizeAmount);
event PrizeDistributed(uint256 indexed roomId, address indexed winner, uint256 amount);
```

## –ë–µ–∑–ø–µ–∫–∞ —Ç–∞ –û–±–º–µ–∂–µ–Ω–Ω—è

### –í–∞–ª—ñ–¥–∞—Ü—ñ—è
- **Entry Fee**: –ü–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ > 0
- **Game Duration**: 60-3600 —Å–µ–∫—É–Ω–¥
- **Max Players**: 2-10 –≥—Ä–∞–≤—Ü—ñ–≤
- **–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è**: –¢—ñ–ª—å–∫–∏ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω—ñ –≥—Ä–∞–≤—Ü—ñ –º–æ–∂—É—Ç—å –≥—Ä–∞—Ç–∏

### –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ü–æ–º–∏–ª–æ–∫
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–Ω–æ—Å—Ç—ñ –∫–æ—à—Ç—ñ–≤
- –ó–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –ø–æ–¥–≤—ñ–π–Ω–æ–º—É –ø—Ä–∏—î–¥–Ω–∞–Ω–Ω—é
- –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–æ–¥–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –ø—ñ—Å–ª—è –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è —á–∞—Å—É
- –ë–µ–∑–ø–µ—á–Ω—ñ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∏ –ø—Ä–∏–∑–æ–≤–∏—Ö –∫–æ—à—Ç—ñ–≤

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –≥—Ä–∏ –ø—Ä–∏ –ø–æ–¥–∞—á—ñ –≤—Å—ñ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –ø—Ä–∏ –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—ñ —á–∞—Å—É
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª –ø—Ä–∏–∑—ñ–≤

## –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ Frontend

### –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏
1. **–°–ø–∏—Å–æ–∫ –î–æ—Å—Ç—É–ø–Ω–∏—Ö –ö—ñ–º–Ω–∞—Ç**: –ü–æ–∫–∞–∑ `getJoinableRooms()`
2. **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ö—ñ–º–Ω–∞—Ç–∏**: –§–æ—Ä–º–∞ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –≥—Ä–∏
3. **–õ—ñ–¥–µ—Ä–±–æ—Ä–¥ –ö—ñ–º–Ω–∞—Ç–∏**: –†–µ–∞–ª-—Ç–∞–π–º –æ–Ω–æ–≤–ª–µ–Ω–Ω—è `getRoomLeaderboard()`
4. **–¢–∞–π–º–µ—Ä –ì—Ä–∏**: –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è `getRemainingTime()`
5. **–°—Ç–∞—Ç—É—Å –ö—ñ–º–Ω–∞—Ç–∏**: –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞–Ω—É —á–µ—Ä–µ–∑ –ø–æ–¥—ñ—ó

### –ü—Ä–∏–∫–ª–∞–¥ Workflow
```javascript
// 1. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫—ñ–º–Ω–∞—Ç–∏
const roomId = await contract.createPVPRoom(
    ethers.utils.parseEther("0.1"), // 0.1 IRYS entry fee
    300, // 5 minutes
    4,   // max 4 players
    { value: ethers.utils.parseEther("0.1") }
);

// 2. –ü—Ä–∏—î–¥–Ω–∞–Ω–Ω—è –¥–æ –∫—ñ–º–Ω–∞—Ç–∏
await contract.joinPVPRoom(roomId, {
    value: ethers.utils.parseEther("0.1")
});

// 3. –ü–æ—á–∞—Ç–æ–∫ –≥—Ä–∏ (—Ç—ñ–ª—å–∫–∏ —Ö–æ—Å—Ç)
await contract.startGame(roomId);

// 4. –ü–æ–¥–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
await contract.submitScoreToRoom(roomId, 1500);

// 5. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–µ—Ä–µ–º–æ–∂—Ü—è
const roomInfo = await contract.getRoomInfo(roomId);
console.log("Winner:", roomInfo.winner);
```

## –ì–∞–∑–æ–≤—ñ –í–∏—Ç—Ä–∞—Ç–∏

- **createPVPRoom**: ~200,000 gas
- **joinPVPRoom**: ~100,000 gas
- **startGame**: ~50,000 gas
- **submitScoreToRoom**: ~80,000 gas
- **finishGame**: ~150,000 gas (–≤–∫–ª—é—á–∞—î —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä –ø—Ä–∏–∑—É)

## –ù–∞—Å—Ç—É–ø–Ω—ñ –ö—Ä–æ–∫–∏

1. **–î–µ–ø–ª–æ–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É**: `npm run deploy`
2. **–û–Ω–æ–≤–ª–µ–Ω–Ω—è Frontend**: –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –Ω–æ–≤–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π
3. **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è**: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—Å—ñ—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤ PVP
4. **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥**: –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –ø–æ–¥—ñ–π —Ç–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π

## –¢–µ—Ö–Ω—ñ—á–Ω—ñ –î–µ—Ç–∞–ª—ñ

- **Solidity Version**: ^0.8.30
- **–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è**: Enabled (200 runs)
- **–†–æ–∑–º—ñ—Ä –ö–æ–Ω—Ç—Ä–∞–∫—Ç—É**: ~27KB bytecode
- **ABI –§—É–Ω–∫—Ü—ñ–π**: 25+ –Ω–æ–≤–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π

–í–∞—à –∫–æ–Ω—Ç—Ä–∞–∫—Ç —Ç–µ–ø–µ—Ä –≥–æ—Ç–æ–≤–∏–π –¥–ª—è –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–æ–≥–æ PVP –≥–µ–π–º–ø–ª–µ—é! üéÆüèÜ